<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.trj.jk.web.mapper.LoanApplyMapper">
  <resultMap id="BaseResultMap" type="com.trj.jk.web.domain.LoanApply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="uid" jdbcType="INTEGER" property="uid" />
    <result column="apply_id" jdbcType="VARCHAR" property="applyId" />
    <result column="product_id" jdbcType="INTEGER" property="productId" />
    <result column="product_name" jdbcType="VARCHAR" property="productName" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="mobile" jdbcType="VARCHAR" property="mobile" />
    <result column="amount" jdbcType="DECIMAL" property="amount" />
    <result column="province" jdbcType="VARCHAR" property="province" />
    <result column="city" jdbcType="VARCHAR" property="city" />
    <result column="district" jdbcType="VARCHAR" property="district" />
    <result column="invitation_code" jdbcType="VARCHAR" property="invitationCode" />
    <result column="tenant" jdbcType="VARCHAR" property="tenant" />
    <result column="status" jdbcType="TINYINT" property="status" />
    <result column="step" jdbcType="TINYINT" property="step" />
    <result column="identity_id" jdbcType="VARCHAR" property="identityId" />
    <result column="is_valid" jdbcType="TINYINT" property="isValid" />
    <result column="vaild_date" jdbcType="DATE" property="vaildDate" />
    <result column="is_manual_audit" jdbcType="TINYINT" property="isManualAudit" />
    <result column="modify_time" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="type" jdbcType="TINYINT" property="type" />
    <result column="order_no" jdbcType="VARCHAR" property="orderNo" />
    <result column="reject_day_info" jdbcType="VARCHAR" property="rejectDayInfo" />
  </resultMap>
  <sql id="Criteria_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    <where>
      <foreach collection="oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Criteria_Where_Clause">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    id, uid, apply_id, product_id, product_name, name, mobile, amount, province, city, 
    district, invitation_code, tenant, status, step, identity_id, is_valid, vaild_date, 
    is_manual_audit, modify_time, create_time, type, order_no, reject_day_info
  </sql>
  <select id="selectByCriteria" parameterType="com.trj.jk.web.domain.LoanApplyCriteria" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from jk_loan_apply
    <if test="_parameter != null">
      <include refid="Criteria_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from jk_loan_apply
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    delete from jk_loan_apply
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByCriteria" parameterType="com.trj.jk.web.domain.LoanApplyCriteria">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    delete from jk_loan_apply
    <if test="_parameter != null">
      <include refid="Criteria_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" keyColumn="id" keyProperty="id" parameterType="com.trj.jk.web.domain.LoanApply" useGeneratedKeys="true">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    insert into jk_loan_apply (uid, apply_id, product_id, 
      product_name, name, mobile, 
      amount, province, city, 
      district, invitation_code, tenant, 
      status, step, identity_id, 
      is_valid, vaild_date, is_manual_audit, 
      modify_time, create_time, type, 
      order_no, reject_day_info)
    values (#{uid,jdbcType=INTEGER}, #{applyId,jdbcType=VARCHAR}, #{productId,jdbcType=INTEGER}, 
      #{productName,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}, 
      #{amount,jdbcType=DECIMAL}, #{province,jdbcType=VARCHAR}, #{city,jdbcType=VARCHAR}, 
      #{district,jdbcType=VARCHAR}, #{invitationCode,jdbcType=VARCHAR}, #{tenant,jdbcType=VARCHAR}, 
      #{status,jdbcType=TINYINT}, #{step,jdbcType=TINYINT}, #{identityId,jdbcType=VARCHAR}, 
      #{isValid,jdbcType=TINYINT}, #{vaildDate,jdbcType=DATE}, #{isManualAudit,jdbcType=TINYINT}, 
      #{modifyTime,jdbcType=TIMESTAMP}, #{createTime,jdbcType=TIMESTAMP}, #{type,jdbcType=TINYINT}, 
      #{orderNo,jdbcType=VARCHAR}, #{rejectDayInfo,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" keyColumn="id" keyProperty="id" parameterType="com.trj.jk.web.domain.LoanApply" useGeneratedKeys="true">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    insert into jk_loan_apply
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="uid != null">
        uid,
      </if>
      <if test="applyId != null">
        apply_id,
      </if>
      <if test="productId != null">
        product_id,
      </if>
      <if test="productName != null">
        product_name,
      </if>
      <if test="name != null">
        name,
      </if>
      <if test="mobile != null">
        mobile,
      </if>
      <if test="amount != null">
        amount,
      </if>
      <if test="province != null">
        province,
      </if>
      <if test="city != null">
        city,
      </if>
      <if test="district != null">
        district,
      </if>
      <if test="invitationCode != null">
        invitation_code,
      </if>
      <if test="tenant != null">
        tenant,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="step != null">
        step,
      </if>
      <if test="identityId != null">
        identity_id,
      </if>
      <if test="isValid != null">
        is_valid,
      </if>
      <if test="vaildDate != null">
        vaild_date,
      </if>
      <if test="isManualAudit != null">
        is_manual_audit,
      </if>
      <if test="modifyTime != null">
        modify_time,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="type != null">
        type,
      </if>
      <if test="orderNo != null">
        order_no,
      </if>
      <if test="rejectDayInfo != null">
        reject_day_info,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="uid != null">
        #{uid,jdbcType=INTEGER},
      </if>
      <if test="applyId != null">
        #{applyId,jdbcType=VARCHAR},
      </if>
      <if test="productId != null">
        #{productId,jdbcType=INTEGER},
      </if>
      <if test="productName != null">
        #{productName,jdbcType=VARCHAR},
      </if>
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null">
        #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="amount != null">
        #{amount,jdbcType=DECIMAL},
      </if>
      <if test="province != null">
        #{province,jdbcType=VARCHAR},
      </if>
      <if test="city != null">
        #{city,jdbcType=VARCHAR},
      </if>
      <if test="district != null">
        #{district,jdbcType=VARCHAR},
      </if>
      <if test="invitationCode != null">
        #{invitationCode,jdbcType=VARCHAR},
      </if>
      <if test="tenant != null">
        #{tenant,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        #{status,jdbcType=TINYINT},
      </if>
      <if test="step != null">
        #{step,jdbcType=TINYINT},
      </if>
      <if test="identityId != null">
        #{identityId,jdbcType=VARCHAR},
      </if>
      <if test="isValid != null">
        #{isValid,jdbcType=TINYINT},
      </if>
      <if test="vaildDate != null">
        #{vaildDate,jdbcType=DATE},
      </if>
      <if test="isManualAudit != null">
        #{isManualAudit,jdbcType=TINYINT},
      </if>
      <if test="modifyTime != null">
        #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="type != null">
        #{type,jdbcType=TINYINT},
      </if>
      <if test="orderNo != null">
        #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="rejectDayInfo != null">
        #{rejectDayInfo,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByCriteria" parameterType="com.trj.jk.web.domain.LoanApplyCriteria" resultType="java.lang.Long">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    select count(*) from jk_loan_apply
    <if test="_parameter != null">
      <include refid="Criteria_Where_Clause" />
    </if>
  </select>
  <update id="updateByCriteriaSelective" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    update jk_loan_apply
    <set>
      <if test="record.id != null">
        id = #{record.id,jdbcType=INTEGER},
      </if>
      <if test="record.uid != null">
        uid = #{record.uid,jdbcType=INTEGER},
      </if>
      <if test="record.applyId != null">
        apply_id = #{record.applyId,jdbcType=VARCHAR},
      </if>
      <if test="record.productId != null">
        product_id = #{record.productId,jdbcType=INTEGER},
      </if>
      <if test="record.productName != null">
        product_name = #{record.productName,jdbcType=VARCHAR},
      </if>
      <if test="record.name != null">
        name = #{record.name,jdbcType=VARCHAR},
      </if>
      <if test="record.mobile != null">
        mobile = #{record.mobile,jdbcType=VARCHAR},
      </if>
      <if test="record.amount != null">
        amount = #{record.amount,jdbcType=DECIMAL},
      </if>
      <if test="record.province != null">
        province = #{record.province,jdbcType=VARCHAR},
      </if>
      <if test="record.city != null">
        city = #{record.city,jdbcType=VARCHAR},
      </if>
      <if test="record.district != null">
        district = #{record.district,jdbcType=VARCHAR},
      </if>
      <if test="record.invitationCode != null">
        invitation_code = #{record.invitationCode,jdbcType=VARCHAR},
      </if>
      <if test="record.tenant != null">
        tenant = #{record.tenant,jdbcType=VARCHAR},
      </if>
      <if test="record.status != null">
        status = #{record.status,jdbcType=TINYINT},
      </if>
      <if test="record.step != null">
        step = #{record.step,jdbcType=TINYINT},
      </if>
      <if test="record.identityId != null">
        identity_id = #{record.identityId,jdbcType=VARCHAR},
      </if>
      <if test="record.isValid != null">
        is_valid = #{record.isValid,jdbcType=TINYINT},
      </if>
      <if test="record.vaildDate != null">
        vaild_date = #{record.vaildDate,jdbcType=DATE},
      </if>
      <if test="record.isManualAudit != null">
        is_manual_audit = #{record.isManualAudit,jdbcType=TINYINT},
      </if>
      <if test="record.modifyTime != null">
        modify_time = #{record.modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.createTime != null">
        create_time = #{record.createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.type != null">
        type = #{record.type,jdbcType=TINYINT},
      </if>
      <if test="record.orderNo != null">
        order_no = #{record.orderNo,jdbcType=VARCHAR},
      </if>
      <if test="record.rejectDayInfo != null">
        reject_day_info = #{record.rejectDayInfo,jdbcType=VARCHAR},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Criteria_Where_Clause" />
    </if>
  </update>
  <update id="updateByCriteria" parameterType="map">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    update jk_loan_apply
    set id = #{record.id,jdbcType=INTEGER},
      uid = #{record.uid,jdbcType=INTEGER},
      apply_id = #{record.applyId,jdbcType=VARCHAR},
      product_id = #{record.productId,jdbcType=INTEGER},
      product_name = #{record.productName,jdbcType=VARCHAR},
      name = #{record.name,jdbcType=VARCHAR},
      mobile = #{record.mobile,jdbcType=VARCHAR},
      amount = #{record.amount,jdbcType=DECIMAL},
      province = #{record.province,jdbcType=VARCHAR},
      city = #{record.city,jdbcType=VARCHAR},
      district = #{record.district,jdbcType=VARCHAR},
      invitation_code = #{record.invitationCode,jdbcType=VARCHAR},
      tenant = #{record.tenant,jdbcType=VARCHAR},
      status = #{record.status,jdbcType=TINYINT},
      step = #{record.step,jdbcType=TINYINT},
      identity_id = #{record.identityId,jdbcType=VARCHAR},
      is_valid = #{record.isValid,jdbcType=TINYINT},
      vaild_date = #{record.vaildDate,jdbcType=DATE},
      is_manual_audit = #{record.isManualAudit,jdbcType=TINYINT},
      modify_time = #{record.modifyTime,jdbcType=TIMESTAMP},
      create_time = #{record.createTime,jdbcType=TIMESTAMP},
      type = #{record.type,jdbcType=TINYINT},
      order_no = #{record.orderNo,jdbcType=VARCHAR},
      reject_day_info = #{record.rejectDayInfo,jdbcType=VARCHAR}
    <if test="_parameter != null">
      <include refid="Update_By_Criteria_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.trj.jk.web.domain.LoanApply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    update jk_loan_apply
    <set>
      <if test="uid != null">
        uid = #{uid,jdbcType=INTEGER},
      </if>
      <if test="applyId != null">
        apply_id = #{applyId,jdbcType=VARCHAR},
      </if>
      <if test="productId != null">
        product_id = #{productId,jdbcType=INTEGER},
      </if>
      <if test="productName != null">
        product_name = #{productName,jdbcType=VARCHAR},
      </if>
      <if test="name != null">
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null">
        mobile = #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="amount != null">
        amount = #{amount,jdbcType=DECIMAL},
      </if>
      <if test="province != null">
        province = #{province,jdbcType=VARCHAR},
      </if>
      <if test="city != null">
        city = #{city,jdbcType=VARCHAR},
      </if>
      <if test="district != null">
        district = #{district,jdbcType=VARCHAR},
      </if>
      <if test="invitationCode != null">
        invitation_code = #{invitationCode,jdbcType=VARCHAR},
      </if>
      <if test="tenant != null">
        tenant = #{tenant,jdbcType=VARCHAR},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=TINYINT},
      </if>
      <if test="step != null">
        step = #{step,jdbcType=TINYINT},
      </if>
      <if test="identityId != null">
        identity_id = #{identityId,jdbcType=VARCHAR},
      </if>
      <if test="isValid != null">
        is_valid = #{isValid,jdbcType=TINYINT},
      </if>
      <if test="vaildDate != null">
        vaild_date = #{vaildDate,jdbcType=DATE},
      </if>
      <if test="isManualAudit != null">
        is_manual_audit = #{isManualAudit,jdbcType=TINYINT},
      </if>
      <if test="modifyTime != null">
        modify_time = #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="type != null">
        type = #{type,jdbcType=TINYINT},
      </if>
      <if test="orderNo != null">
        order_no = #{orderNo,jdbcType=VARCHAR},
      </if>
      <if test="rejectDayInfo != null">
        reject_day_info = #{rejectDayInfo,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.trj.jk.web.domain.LoanApply">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    update jk_loan_apply
    set uid = #{uid,jdbcType=INTEGER},
      apply_id = #{applyId,jdbcType=VARCHAR},
      product_id = #{productId,jdbcType=INTEGER},
      product_name = #{productName,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      mobile = #{mobile,jdbcType=VARCHAR},
      amount = #{amount,jdbcType=DECIMAL},
      province = #{province,jdbcType=VARCHAR},
      city = #{city,jdbcType=VARCHAR},
      district = #{district,jdbcType=VARCHAR},
      invitation_code = #{invitationCode,jdbcType=VARCHAR},
      tenant = #{tenant,jdbcType=VARCHAR},
      status = #{status,jdbcType=TINYINT},
      step = #{step,jdbcType=TINYINT},
      identity_id = #{identityId,jdbcType=VARCHAR},
      is_valid = #{isValid,jdbcType=TINYINT},
      vaild_date = #{vaildDate,jdbcType=DATE},
      is_manual_audit = #{isManualAudit,jdbcType=TINYINT},
      modify_time = #{modifyTime,jdbcType=TIMESTAMP},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      type = #{type,jdbcType=TINYINT},
      order_no = #{orderNo,jdbcType=VARCHAR},
      reject_day_info = #{rejectDayInfo,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectByCriteriaWithRowbounds" parameterType="com.trj.jk.web.domain.LoanApplyCriteria" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 07 11:26:34 CST 2017.
    -->
    select
    <if test="distinct">
      distinct
    </if>
    <include refid="Base_Column_List" />
    from jk_loan_apply
    <if test="_parameter != null">
      <include refid="Criteria_Where_Clause" />
    </if>
    <if test="orderByClause != null">
      order by ${orderByClause}
    </if>
  </select>
  
  <select id="selectValidateLimitAuditList" parameterType="Map" resultType="com.trj.jk.web.domain.entity.LimitAuditBean">
  	SELECT 
  		apply.id AS applyId,apply.uid AS uid,apply.product_id AS productId,product.product_code AS productCode,product.`name` AS productName,apply.`status` AS `status`,product.repay_type AS repayType,apply.amount AS applyAmount,date_format(apply.create_time,'%Y/%c/%d') AS applyTime,date_format(apply.vaild_date,'%Y/%c/%d') AS vailDate,date_format(audit.audit_time,'%Y/%c/%d') AS auditTime,audit.amount_limit AS auditAmount,audit.rest_limit AS restLimit,
  		audit.amount_limit_calculate_1 AS amountLimitCalculate1,audit.amount_limit_calculate_2 AS amountLimitCalculate2,audit.term_1 AS term1,audit.term_2 AS term2,audit.interest AS interest,audit.rate_type AS rateType,audit.term_unit AS termUnit
  	FROM jk_loan_apply apply 
  	LEFT JOIN jk_loan_audit audit ON audit.apply_loan_id=apply.id 
  	LEFT JOIN jk_loan_product product ON apply.product_id=product.id 
  	WHERE apply.is_valid=1 AND apply.uid=${uid}  AND product.product_code != 'C12' AND apply.`status`!=0
  </select>
  
  <select id="selectInvalidLimitAuditList" parameterType="Map" resultType="com.trj.jk.web.domain.entity.LimitAuditBean">
  	SELECT 
		apply.id AS applyId,apply.uid AS uid,apply.product_id AS productId,product.product_code AS productCode,product.`name` AS productName,apply.`status` AS `status`,product.repay_type AS repayType,apply.amount AS applyAmount,date_format(apply.create_time,'%Y/%c/%d') AS applyTime,date_format(apply.vaild_date,'%Y/%c/%d') AS vailDate,date_format(audit.audit_time,'%Y/%c/%d') AS auditTime,audit.amount_limit AS auditAmount,audit.rest_limit AS restLimit, 
  		audit.amount_limit_calculate_1 AS amountLimitCalculate1,audit.amount_limit_calculate_2 AS amountLimitCalculate2,audit.term_1 AS term1,audit.term_2 AS term2,audit.interest AS interest,audit.rate_type AS rateType,audit.term_unit AS termUnit
  	FROM jk_loan_apply apply 
  	LEFT JOIN jk_loan_audit audit ON audit.apply_loan_id=apply.id 
  	LEFT JOIN jk_loan_product product ON apply.product_id=product.id 
	WHERE apply.is_valid=0 AND apply.uid=${uid} AND product.product_code != 'C12' AND apply.`status`!=0
  </select>

  <select id="selectLimitAuditListByProductCode" parameterType="Map" resultType="com.trj.jk.web.domain.entity.LimitAuditBean">
    SELECT
    apply.id AS applyId,apply.uid AS uid,apply.product_id AS productId,product.product_code AS productCode,product.`name` AS productName,apply.`status` AS `status`,product.repay_type AS repayType,apply.amount AS applyAmount,date_format(apply.create_time,'%Y/%c/%d') AS applyTime,date_format(apply.vaild_date,'%Y/%c/%d') AS vailDate,date_format(audit.audit_time,'%Y/%c/%d') AS auditTime,audit.amount_limit AS auditAmount,audit.rest_limit AS restLimit,
    audit.amount_limit_calculate_1 AS amountLimitCalculate1,audit.amount_limit_calculate_2 AS amountLimitCalculate2,audit.term_1 AS term1,audit.term_2 AS term2,audit.interest AS interest,audit.rate_type AS rateType,audit.term_unit AS termUnit
    FROM jk_loan_apply apply
    LEFT JOIN jk_loan_audit audit ON audit.apply_loan_id=apply.id
    LEFT JOIN jk_loan_product product ON apply.product_id=product.id
    WHERE apply.is_valid=1 AND apply.uid=${uid} AND product.product_code='${productCode}' AND apply.`status`!=0
  </select>
  <select id="queryRefuseApplyInMonth" resultType="com.trj.jk.web.domain.LoanApply">
    select <include refid="Base_Column_List" /> from jk_loan_apply where uid = #{uid} and product_id =#{productId} and status = 3 and (TO_DAYS(CURDATE())-TO_DAYS(create_time))  &lt; 30
  </select>


  <select id="queryRefuseApplyByVaildDate"  resultMap="BaseResultMap" >
    select * from jk_loan_apply where uid = #{uid} and product_id =#{productId} and status = 3 and (TO_DAYS(CURDATE())-TO_DAYS(vaild_date))  &lt; 0
  </select>


  <select flushCache="true" id="getLoanApplyListByProductCode" resultType="java.util.HashMap" useCache="false">
    SELECT a.* FROM jk_loan_apply a ,jk_loan_product b where a.product_id = b.id and a.is_valid = 1 AND a.uid=#{uid} AND b.product_code = #{productCode,jdbcType=VARCHAR}
  </select>

</mapper>